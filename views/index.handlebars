<div class="loader_overlay">
   <div class="loader_wrapper">
      <div class="loader"></div>
      <p class="loader_text loader_text-1">Our robots are looking for the cool stuff.</p>
      <p class="loader_text loader_text-2">I hope you're having a nice day.</p>
      <p class="loader_text loader_text-3">Soon the computers will just take over.</p>
      <p class="loader_text loader_text-4">The things are doing the stuff.</p>
      <p class="loader_text loader_text-5">Your hair looks pretty.</p>
   </div>
</div>

{{#if projects}}
{{else}}
<div class="feed__container">
   <div class="feed__container-text">
      <h1 class="main__title">{{greeting}} {{user.username}},</h1>
      <p class="main__info feed__text">We see you're not following anyone, <a href="/explore"><strong>let's go explore.</strong></a></p>
   </div>
</div>
{{/if}}

<div class="explore_main">

   {{#if projects}}

   <p class="top_results">{{greeting}} {{user.username}}</p>
   <hr class="top_results_underline" />

   <div class="masonryContainer">

      {{#each projects}}

         {{#if this.is_private}}
         {{! Check if the project is a private project, we do not want to show private projects }}
         {{else}}

            {{#if is_micro_post}}

               {{#if posted_to_group}}
                  {{#each posted_to_group}}
                     {{#ifEquals this.group_is_private "true"}}
                        {{! Don't show projects in private groups }}
                     {{else}}
                        <div class="masonryItem ownProject" title="{{../project_title}}">
                           <div class="micropost">
                              <input class="likes_length" type="hidden" name="likes_length" value="{{../likes.length}}">
                              <input class="reposts_length" type="hidden" name="reposts_length" value="{{../reposts.length}}">
                              <input class="saves_length" type="hidden" name="saves_length" value="{{../saves.length}}">
                              <input class="micro_project" type="hidden" name="project_id" value="{{../_id}}">
                              <input class="micro_owner" type="hidden" name="project_owner" value="{{../project_owner}}">
                              <div class="micropost_card">
                                 {{#if ../micro_image}}<img src="https://s3.amazonaws.com/hryzn-app-static-assets/{{../micro_image}}" class="img-responsive" alt="{{../micro_body}}" />{{/if}}
                                 <p>
                                    {{{../micro_body}}}
                                    {{#if ../project_url}}<br /><br /><a target="_blank" href="https://{{../project_url}}">View Link</a>{{/if}}
                                 </p>
                              </div>
                              <a class="micro_tag" href="/profile/{{../project_owner}}">@{{../project_owner}}</a>
                           </div>
                        </div>
                     {{/ifEquals}}
                  {{/each}}
               {{else}}
                  <div class="masonryItem ownProject" title="{{project_title}}">
                     <div class="micropost">
                        <input class="likes_length" type="hidden" name="likes_length" value="{{likes.length}}">
                        <input class="reposts_length" type="hidden" name="reposts_length" value="{{reposts.length}}">
                        <input class="saves_length" type="hidden" name="saves_length" value="{{saves.length}}">
                        <input class="micro_project" type="hidden" name="project_id" value="{{_id}}">
                        <input class="micro_owner" type="hidden" name="project_owner" value="{{project_owner}}">
                        <div class="micropost_card">
                           {{#if micro_image}}<img src="https://s3.amazonaws.com/hryzn-app-static-assets/{{micro_image}}" class="img-responsive" alt="{{micro_body}}" />{{/if}}
                           <p>
                              {{{micro_body}}}
                              {{#if project_url}}<br /><br /><a target="_blank" href="https://{{project_url}}">View Link</a>{{/if}}
                           </p>
                        </div>
                        <a class="micro_tag" href="/profile/{{project_owner}}">@{{project_owner}}</a>
                     </div>
                  </div>
               {{/if}}

            {{else}}

               {{#if posted_to_group}}
                  {{#each posted_to_group}}
                     {{#ifEquals this.group_is_private "true"}}
                        {{! Don't show projects in private groups }}
                     {{else}}
                        <div class="masonryItem ownProject" title="{{../project_title}}">
                           <div class="project_card">
                              <a href="/p/details/{{../id}}" class="project_link">
                                 <img src="https://s3.amazonaws.com/hryzn-app-static-assets/{{#if ../thumbnail_image}}{{../thumbnail_image}}{{else}}{{../project_image}}{{/if}}" class="img-responsive" alt="{{../project_title}}" />
                              </a>
                              <div class="project_card_bottom">
                                 <div class="project_bottom_wrapper">
                                    <div class="bg_overlay"></div>
                                    <div class="project_bottom_details">
                                       <a href="/profile/{{../project_owner}}"><p class="project_owner">@{{../project_owner}}</p></a>
                                       <a href="/p/details/{{../id}}" class="project_link">
                                          <p class="project_card_title">{{../project_title}}</p>
                                       </a>
                                    </div>
                                 </div>
                              </div>
                           </div>
                        </div>
                     {{/ifEquals}}
                  {{/each}}
               {{else}}
                  <div class="masonryItem ownProject" title="{{project_title}}">
                     <div class="project_card">
                        <a href="/p/details/{{id}}" class="project_link">
                           <img src="https://s3.amazonaws.com/hryzn-app-static-assets/{{#if thumbnail_image}}{{thumbnail_image}}{{else}}{{project_image}}{{/if}}" class="img-responsive" alt="{{project_title}}" />
                        </a>
                        <div class="project_card_bottom">
                           <div class="project_bottom_wrapper">
                              <div class="bg_overlay"></div>
                              <div class="project_bottom_details">
                                 <a href="/profile/{{project_owner}}"><p class="project_owner">@{{project_owner}}</p></a>
                                 <a href="/p/details/{{id}}" class="project_link">
                                    <p class="project_card_title">{{project_title}}</p>
                                 </a>
                              </div>
                           </div>
                        </div>
                     </div>
                  </div>
               {{/if}}

            {{/if}}

         {{/if}}
      {{/each}}

   </div>

   <div id="micropostPop">
      <div class="micropostPop_wrapper">
         <a href="javascript:void(0)" class="microPopClose">&times;</a>
         <div class="micropostPop_container"></div>

         <div class="project_btn_wrapper">

            <div class="repostModal modalBackground">
               <div class="modal-content">
                  <div class="modal-header ">
                     <p>Where would you like to repost to?</p>
                  </div>
                  <form id="micro_repost" title="repost" method="post" action="/p/details/micro/repost/{{project.id}}">
                     <input type="hidden" name="username" value="{{user.username}}">
                     <input class="micro_project" type="hidden" name="project_id" value="{{project.id}}">
                     <input class="micro_owner" type="hidden" name="project_owner" value="{{project.project_owner}}">
                     <input class="og_path" type="hidden" name="og_path" value="{{og_path}}">
                     <select data-placeholder="Repost to..." class="chosen-select form__input" name="repost_to">
                        <option value=""></option>
                        <option value="followers">Followers</option>
                        {{#each user.groups}}
                        <option value="{{this.group_id}}">Your Group "{{this.group_name}}"</option>
                        {{/each}}
                     </select>
                     <div class="modal-footer">
                        <input class="btn__secondary repost_submit" type="submit" value="Repost"/>
                        <span class="closeModal btn__primary">Cancel</span>
                     </div>
                  </form>

                  <form id="micro_unrepost" title="unrepost" method="post" action="/p/details/micro/unrepost/{{project.id}}">
                     <input class="micro_project" type="hidden" name="project_id" value="{{project.id}}">
                     <input class="og_path" type="hidden" name="og_path" value="{{og_path}}">
                     <input class="btn__secondary unrepost_btn" type="submit" value="I'm actually trying to unrepost this"/>
                  </form>
               </div>
            </div>

            <div class="repostModalBtn project_action_btn">
               <img src="/icons/repost.png" class="project_icon" />
               <p class="reposts_length"></p>
            </div>

            <form id="micro_save" title="save" method="post" action="/p/details/micro/save/{{project.id}}">
               <input type="hidden" name="username" value="{{user.username}}">
               <input class="micro_project" type="hidden" name="project_id" value="{{project.id}}">
               <input class="micro_owner" type="hidden" name="project_owner" value="{{project.project_owner}}">
               <input class="og_path" type="hidden" name="og_path" value="{{og_path}}">
               <button class="project_action_btn middle_btn" name="submit" type="submit">
                  <img src="/icons/save.png" class="project_icon" />
                  <p class="saves_length"></p>
               </button>
            </form>

            <form id="micro_like" title="like" method="post" action="/p/details/micro/like/{{project.id}}">
               <input type="hidden" name="username" value="{{user.username}}">
               <input class="micro_project" type="hidden" name="project_id" value="{{project.id}}">
               <input class="micro_owner" type="hidden" name="project_owner" value="{{project.project_owner}}">
               <input class="og_path" type="hidden" name="og_path" value="{{og_path}}">
               <button class="project_action_btn" name="submit" type="submit">
                  <img src="/icons/heart-unliked.png" class="project_icon" />
                  <p class="likes_length"></p>
               </button>
            </form>

         </div>

      </div>
   </div>

   {{/if}}

</div>
